# 橘猫和贵宾 - 声音素材制作过程记录

> 项目目标：为动画角色"橘猫大哥"和"贵宾小姐"制作AI配音
> 开始日期：2024-01-24

---

## 一、角色声音定位

### 1.1 角色分析

| 角色 | 形象 | 声音风格 | 口音 |
|------|------|----------|------|
| 橘猫大哥 | 全身LV、粗金链、痞帅土豪 | 社会大哥、拽、横 | 东北腔普通话 |
| 贵宾小姐 | 金色比基尼、名媛风 | 嗲嗲的、撒娇、傲娇 | 台湾腔/女汉子风 |

### 1.2 参考音色

**橘猫大哥**：
- 参考：PDD、宋小宝的痞帅感
- 关键词：社会味、东北腔、有钱任性

**贵宾小姐**：
- 参考：女汉子风格
- 关键词：泼辣、直爽

---

## 二、素材获取

### 2.1 原始视频

| 文件名 | 来源 | 时长 | 用途 |
|--------|------|------|------|
| 46_1769245817.mp4 | 抖音 | 10.67秒 | 女汉子声音样本 |
| 47_1769246102.mp4 | 抖音 | 11.77秒 | 社会大哥声音样本 |

### 2.2 音频提取

**工具**：ffmpeg

**命令**：
```bash
# 从MP4提取音频为MP3
ffmpeg -i "输入视频.mp4" -vn -acodec libmp3lame -q:a 2 "输出音频.mp3" -y
```

**参数说明**：
- `-vn`：不处理视频流（只要音频）
- `-acodec libmp3lame`：使用LAME编码器输出MP3
- `-q:a 2`：音质等级（0-9，越小质量越高，2约等于190kbps）
- `-y`：覆盖已存在的文件

**执行记录**：

```bash
# 2024-01-24 17:11 - 提取女汉子声音
ffmpeg -i "46_1769245817.mp4" -vn -acodec libmp3lame -q:a 2 "声音素材/46_1769245817_audio.mp3" -y
# 输出：134KB，10.66秒

# 2024-01-24 17:11 - 提取社会大哥声音
ffmpeg -i "47_1769246102.mp4" -vn -acodec libmp3lame -q:a 2 "声音素材/47_1769246102_audio.mp3" -y
# 输出：232KB，11.74秒
```

**产出文件**：
- `46_1769245817_audio.mp3` → 重命名为 `女汉子声音样本.mp3`
- `47_1769246102_audio.mp3` → 重命名为 `社会大哥声音样本.mp3`

---

## 三、人声分离

### 3.1 问题

原始音频包含背景音乐和噪声，会影响声音克隆效果。

### 3.2 解决方案

**工具**：demucs（Meta开源的AI音源分离工具）

**安装**：
```bash
pip install demucs
```

**命令**：
```bash
# 分离人声和背景音
demucs --two-stems=vocals "输入音频.mp3" -o "./separated"
```

**参数说明**：
- `--two-stems=vocals`：只分离为两个音轨（人声 + 其他）
- `-o "./separated"`：输出目录

**执行记录**：

```bash
# 2024-01-24 23:21 - 分离社会大哥人声
cd "声音素材目录"
demucs --two-stems=vocals "社会大哥声音样本.mp3" -o "./separated"
# 输出目录：separated/htdemucs/社会大哥声音样本/
#   - vocals.wav（纯人声）
#   - no_vocals.wav（背景音乐/噪声）

# 2024-01-24 23:21 - 分离女汉子人声
demucs --two-stems=vocals "女汉子声音样本.mp3" -o "./separated"
# 输出目录：separated/htdemucs/女汉子声音样本/
#   - vocals.wav（纯人声）
#   - no_vocals.wav（背景音乐/噪声）
```

### 3.3 格式转换

demucs 输出的是 WAV 格式，需要转换为 MP3 方便使用。

**命令**：
```bash
# WAV 转 MP3
ffmpeg -i "vocals.wav" -acodec libmp3lame -q:a 2 "输出_纯人声.mp3" -y
```

**执行记录**：

```bash
# 复制并转换社会大哥纯人声
cp "separated/htdemucs/社会大哥声音样本/vocals.wav" "社会大哥声音样本_纯人声.wav"
ffmpeg -i "社会大哥声音样本_纯人声.wav" -acodec libmp3lame -q:a 2 "社会大哥声音样本_纯人声.mp3" -y
# 输出：215KB，11.74秒

# 复制并转换女汉子纯人声
cp "separated/htdemucs/女汉子声音样本/vocals.wav" "女汉子声音样本_纯人声.wav"
ffmpeg -i "女汉子声音样本_纯人声.wav" -acodec libmp3lame -q:a 2 "女汉子声音样本_纯人声.mp3" -y
# 输出：179KB，10.65秒
```

### 3.4 产出文件

| 文件 | 大小 | 时长 | 说明 |
|------|------|------|------|
| 社会大哥声音样本_纯人声.mp3 | 215KB | 11.74秒 | 用于克隆橘猫大哥声音 |
| 女汉子声音样本_纯人声.mp3 | 179KB | 10.65秒 | 用于克隆贵宾小姐声音 |

---

## 四、声音克隆（已完成）

### 4.1 平台选择

**MiniMax**（国内最优选择）

**价格**（2025年2月更新后）：
- 声音克隆：9.9元/音色
- TTS HD模型：3.5元/万字符
- TTS Turbo模型：2元/万字符

**注意**：1个中文字符按2个字符计费

### 4.2 API调用流程

```
1. 上传音频文件 → 获取 file_id
   POST https://api.minimax.chat/v1/files/upload?GroupId=xxx

2. 调用克隆接口 → 获取 voice_id
   POST https://api.minimax.chat/v1/voice_clone?GroupId=xxx

3. 使用克隆音色合成语音
   POST https://api.minimax.chat/v1/t2a/v2?GroupId=xxx
```

### 4.3 音频要求

- 格式：mp3、m4a、wav
- 时长：10秒 ~ 5分钟
- 大小：不超过 20MB
- 质量：纯人声、无背景音乐、清晰

### 4.4 实际费用

| 项目 | 数量 | 费用 |
|------|------|------|
| 橘猫大哥声音克隆 | 1个 | 9.9元 |
| 贵宾小姐声音克隆 | 1个 | 9.9元 |
| **总计** | - | **19.8元** |

### 4.5 克隆结果汇总

#### ✅ 最终使用的 Voice ID

| 角色 | Voice ID | 素材文件 | 素材时长 | 状态 |
|------|----------|----------|----------|------|
| **橘猫大哥** | `shehui_dage_jumu_002` | 社会大哥声音样本2_纯人声.mp3 | 22.8秒 | ✅ 采用 |
| **贵宾小姐** | `guibin_xiaojie_001` | 贵宾小姐声音样本_纯人声.mp3 | 13.0秒 | ✅ 采用 |

#### 废弃的 Voice ID

| 角色 | Voice ID | 原因 |
|------|----------|------|
| 橘猫大哥 | `shehui_dage_jumu_001` | 效果不佳，换了更长的素材 |

### 4.6 执行记录

```bash
# 2024-01-24 23:38 - 第一次克隆橘猫大哥（效果不佳）
# 素材：社会大哥声音样本_纯人声.mp3 (11.74秒)
curl -X POST "https://api.minimax.chat/v1/files/upload?GroupId=xxx" \
  -F "file=@社会大哥声音样本_纯人声.mp3" -F "purpose=voice_clone"
# file_id: 359285085085775

curl -X POST "https://api.minimax.chat/v1/voice_clone?GroupId=xxx" \
  -d '{"file_id": 359285085085775, "voice_id": "shehui_dage_jumu_001", ...}'
# 结果：效果不佳，弃用

# 2024-01-24 23:44 - 第二次克隆橘猫大哥（采用）
# 素材：社会大哥声音样本2_纯人声.mp3 (22.8秒)
# 来源视频：48_1769269295.mp4
curl -X POST "https://api.minimax.chat/v1/files/upload?GroupId=xxx" \
  -F "file=@社会大哥声音样本2_纯人声.mp3" -F "purpose=voice_clone"
# file_id: 359286648844681

curl -X POST "https://api.minimax.chat/v1/voice_clone?GroupId=xxx" \
  -d '{"file_id": 359286648844681, "voice_id": "shehui_dage_jumu_002", ...}'
# 结果：✅ 效果满意，采用

# 2024-01-24 23:51 - 克隆贵宾小姐（采用）
# 素材：贵宾小姐声音样本_纯人声.mp3 (13.0秒)
# 来源视频：49_1769269768.mp4
curl -X POST "https://api.minimax.chat/v1/files/upload?GroupId=xxx" \
  -F "file=@贵宾小姐声音样本_纯人声.mp3" -F "purpose=voice_clone"
# file_id: 359285841867191

curl -X POST "https://api.minimax.chat/v1/voice_clone?GroupId=xxx" \
  -d '{"file_id": 359285841867191, "voice_id": "guibin_xiaojie_001", ...}'
# 结果：✅ 效果满意，采用
```

### 4.7 试听文件

| 角色 | 试听文件 |
|------|----------|
| 橘猫大哥 | 社会大哥_克隆试听2.mp3 |
| 贵宾小姐 | 贵宾小姐_克隆试听.mp3 |

---

## 五、工作流总结

### 5.1 完整流程图

```
┌─────────────────────────────────────────────────────────────┐
│                    声音克隆工作流                            │
└─────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────┐
│  Step 1: 获取原始素材                                        │
│  ────────────────────                                       │
│  • 从抖音/B站找到合适的声音视频                               │
│  • 下载视频（cobalt.tools 或 yt-dlp）                        │
└─────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────┐
│  Step 2: 提取音频                                            │
│  ────────────────────                                       │
│  ffmpeg -i "video.mp4" -vn -acodec libmp3lame -q:a 2 "audio.mp3" │
└─────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────┐
│  Step 3: 人声分离（如有背景音乐/噪声）                        │
│  ────────────────────                                       │
│  demucs --two-stems=vocals "audio.mp3" -o "./separated"     │
│  → 输出 vocals.wav（纯人声）                                 │
└─────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────┐
│  Step 4: 格式转换（可选）                                    │
│  ────────────────────                                       │
│  ffmpeg -i "vocals.wav" -acodec libmp3lame -q:a 2 "vocals.mp3" │
└─────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────┐
│  Step 5: 声音克隆                                            │
│  ────────────────────                                       │
│  • 上传纯人声音频到 MiniMax                                  │
│  • 调用 voice_clone 接口获取 voice_id                        │
│  • 费用：9.9元/音色                                          │
└─────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────┐
│  Step 6: 语音合成                                            │
│  ────────────────────                                       │
│  • 使用 voice_id 调用 T2A 接口                               │
│  • 输入文字 → 输出克隆音色的语音                             │
│  • 费用：2-3.5元/万字符                                      │
└─────────────────────────────────────────────────────────────┘
```

### 5.2 一键脚本（待完善）

```bash
#!/bin/bash
# voice_clone_workflow.sh
# 声音克隆一键工作流

INPUT_VIDEO=$1
OUTPUT_NAME=$2

# Step 1: 提取音频
ffmpeg -i "$INPUT_VIDEO" -vn -acodec libmp3lame -q:a 2 "${OUTPUT_NAME}_raw.mp3" -y

# Step 2: 人声分离
demucs --two-stems=vocals "${OUTPUT_NAME}_raw.mp3" -o "./separated"

# Step 3: 转换格式
ffmpeg -i "./separated/htdemucs/${OUTPUT_NAME}_raw/vocals.wav" \
       -acodec libmp3lame -q:a 2 "${OUTPUT_NAME}_纯人声.mp3" -y

echo "完成！纯人声文件：${OUTPUT_NAME}_纯人声.mp3"
```

---

## 六、参考资源

### 6.1 工具链接

| 工具 | 用途 | 链接 |
|------|------|------|
| ffmpeg | 音视频处理 | https://ffmpeg.org/ |
| demucs | 人声分离 | https://github.com/facebookresearch/demucs |
| MiniMax | 声音克隆/TTS | https://platform.minimaxi.com/ |
| cobalt | 视频下载 | https://cobalt.tools/ |
| CosyVoice | 免费声音克隆 | https://www.modelscope.cn/studios/iic/CosyVoice2-0.5B |

### 6.2 定价参考

- MiniMax 定价：https://platform.minimaxi.com/docs/guides/pricing-payg

---

## 七、图生视频制作原则（重要经验）

### ⚠️ 角色一致性控制

通过实践摸索出的关键原则：

| 原则 | 说明 |
|------|------|
| **人物不能离开镜头** | 两个角色必须始终在画面中，否则AI会自行想象，角色外观失控 |
| **固定机位** | 双人对话必须固定机位，行走场景让背景移动，而非人物走出画面 |
| **切回原图** | 如果角色数量变化（2→1），必须切换回原始起始帧重新生成 |
| **Prompt写法** | 明确"两个角色始终在画面中"，使用"camera follows"，避免"walks away" |

---

## 八、更新日志

| 日期 | 内容 |
|------|------|
| 2024-01-24 17:11 | 创建项目，完成角色声音定位 |
| 2024-01-24 17:15 | 完成视频音频提取 |
| 2024-01-24 23:21 | 完成人声分离，得到纯人声素材 |
| 2024-01-24 23:38 | 第一次克隆橘猫大哥，效果不佳 |
| 2024-01-24 23:44 | 更换素材，重新克隆橘猫大哥，效果满意 ✅ |
| 2024-01-24 23:51 | 克隆贵宾小姐，效果满意 ✅ |
| 2024-01-25 00:xx | 总结图生视频角色一致性控制原则 |
| - | 待续：完善人设、剧本、视频制作 |

---

*文档持续更新中...*
